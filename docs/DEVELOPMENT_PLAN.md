# 账号密码管理系统 - 开发计划表

> 版本：v1.8
> 更新时间：2026-01-03
> 当前状态：IP黑名单、Redis缓存、API版本控制完成

---

## 📊 项目当前状态

### ✅ 已完成功能

| 模块 | 功能 | 状态 | 说明 |
|------|------|:----:|------|
| **数据库设计** | 表结构设计 | ✅ | 6张表：平台类型、平台、账号、用户、登录日志、操作日志 |
| **数据库设计** | 初始化数据 | ✅ | 18种平台类型，80+平台 |
| **基础框架** | Spring Boot 3.4 | ✅ | Java 17 支持 |
| **ORM** | MyBatis Plus 3.5 | ✅ | 分页、逻辑删除、自动填充 |
| **API文档** | Knife4j | ✅ | OpenAPI 3 规范 |
| **平台类型管理** | CRUD | ✅ | 增删改查完整 |
| **平台管理** | CRUD + 分页 | ✅ | 支持按类型筛选 |
| **账号管理** | CRUD + 分页 | ✅ | 多条件查询、批量删除 |
| **密码加密** | AES-256 | ✅ | 每账号独立盐值 |
| **密码查看** | 解密接口 | ✅ | 前端可获取明文 |
| **单元测试** | 核心功能测试 | ✅ | 工具类、Service、Controller |
| **快捷打开平台** | 一键跳转 | ✅ | 账号列表打开平台网站 |
| **快捷键支持** | 键盘操作 | ✅ | Ctrl+C复制密码、Ctrl+N新建等 |
| **数据可视化** | 图表展示 | ✅ | ECharts 饼图、柱状图、折线图 |
| **国际化** | 多语言 | ✅ | 中英文切换支持 |
| **统一响应** | Result 封装 | ✅ | 统一状态码和消息 |
| **全局异常** | 异常处理器 | ✅ | 业务异常、参数校验异常 |
| **用户认证** | JWT 无状态认证 | ✅ | 登录、登出、令牌刷新 |
| **接口权限** | JWT 过滤器 | ✅ | 白名单机制，保护 API |
| **登录日志** | 登录记录 | ✅ | 记录登录时间、IP、浏览器 |
| **操作日志** | 审计日志 | ✅ | AOP 切面记录敏感操作 |
| **密码生成器** | 随机密码生成 | ✅ | 多种规则、强度检测 |
| **批量导入导出** | Excel 操作 | ✅ | EasyExcel 实现 |
| **密码过期提醒** | 过期检测 | ✅ | 可配置有效期，到期提醒 |
| **HTTPS** | 配置文档 | ✅ | 开发/生产环境配置指南 |
| **数据备份恢复** | 自动备份 | ✅ | 定时备份、手动备份、恢复 |
| **密码历史** | 历史记录 | ✅ | 记录密码修改历史 |
| **标签系统** | 分组管理 | ✅ | 自定义标签、多对多关联 |
| **数据脱敏** | 敏感信息 | ✅ | 密码、手机、邮箱脱敏 |
| **二次验证** | 安全确认 | ✅ | 查看密码需二次验证 |
| **账号搜索增强** | 高级搜索 | ✅ | 全文搜索、多条件筛选 |
| **收藏功能** | 快捷访问 | ✅ | 常用账号收藏置顶 |
| **最近使用记录** | 访问记录 | ✅ | 记录最近访问的账号 |
| **统计仪表盘** | 数据统计 | ✅ | 账号数量、分布统计 |
| **密钥轮转** | 安全升级 | ✅ | AES密钥更换功能 |
| **接口限流** | 安全防护 | ✅ | 防止恶意请求 |
| **用户管理** | 管理员CRUD | ✅ | 用户增删改查、重置密码 |
| **日志查询接口** | 日志管理 | ✅ | 登录日志、操作日志查询与删除 |
| **用户资料更新** | 个人信息 | ✅ | 更新昵称、邮箱、头像等 |
| **环境配置** | 生产配置 | ✅ | application-prod.yaml，环境变量支持 |
| **Token刷新** | 前端 | ✅ | 自动刷新、请求队列管理 |
| **账号导入** | 前端 | ✅ | Excel批量导入、模板下载 |
| **账号详情页** | 前端 | ✅ | 完整的账号信息展示页面 |
| **登录安全机制** | 后端 | ✅ | 5次失败锁定30分钟 |
| **集成测试** | 测试 | ✅ | 主要API端到端测试 |
| **单元测试** | 测试 | ✅ | Service层、Controller层测试，50个测试用例 |
| **XSS防护** | 安全 | ✅ | XssFilter 过滤危险输入 |
| **Docker容器化** | DevOps | ✅ | 多阶段构建、docker-compose |
| **CI/CD** | DevOps | ✅ | GitHub Actions 自动化流水线 |
| **响应式布局** | 前端 | ✅ | 移动端自适应、侧边栏抽屉 |
| **IP黑名单** | 安全 | ✅ | 自动封禁恶意IP、手动管理 |
| **Redis缓存** | 性能 | ✅ | 平台类型、仪表盘数据缓存 |
| **API版本控制** | 架构 | ✅ | URL路径版本控制 /api/v1/ |

### ⚠️ 待改进项

| 问题 | 严重程度 | 解决方案 |
|------|:--------:|----------|
| SonarQube | 低 | 代码质量静态分析 |
| 消息队列 | 低 | 异步处理日志、通知 |
| 密码加密升级 | 低 | Argon2 替代 AES |

---

## 🚀 后续开发计划

### 阶段一：安全加固（优先级：高）

| 序号 | 功能 | 描述 | 工作量 |
|:----:|------|------|:------:|
| 1.1 | **用户认证模块** | 实现管理员登录功能 | 2天 |
| 1.2 | **JWT Token** | 基于 JWT 的无状态认证 | 1天 |
| 1.3 | **接口权限控制** | 所有接口需要认证才能访问 | 0.5天 |
| 1.4 | **密码强度校验** | 账号密码复杂度要求 | 0.5天 |
| 1.5 | **登录日志** | 记录登录时间、IP等 | 0.5天 |
| 1.6 | **HTTPS 配置** | 生产环境强制 HTTPS | 0.5天 |

### 阶段二：功能增强（优先级：中高）

| 序号 | 功能 | 描述 | 状态 |
|:----:|------|------|:------:|
| 2.1 | **密码历史记录** | 记录密码修改历史 | ✅ 已完成 |
| 2.2 | **密码生成器** | 自动生成强密码 | ✅ 已完成 |
| 2.3 | **账号分组/标签** | 支持自定义分组管理 | ✅ 已完成 |
| 2.4 | **批量导入导出** | Excel 批量操作 | ✅ 已完成 |
| 2.5 | **账号搜索增强** | 全文搜索、模糊匹配 | ✅ 已完成 |
| 2.6 | **账号复制** | 快速复制账号信息 | ✅ 已完成 |
| 2.7 | **快捷打开平台** | 一键跳转平台登录页 | ✅ 已完成 |
| 2.8 | **密码过期提醒** | 定期提醒更换密码 | ✅ 已完成 |

### 阶段三：数据安全（优先级：高）

| 序号 | 功能 | 描述 | 状态 |
|:----:|------|------|:------:|
| 3.1 | **操作审计日志** | 记录所有敏感操作 | ✅ 已完成 |
| 3.2 | **数据备份** | 定时自动备份 | ✅ 已完成 |
| 3.3 | **数据恢复** | 从备份恢复数据 | ✅ 已完成 |
| 3.4 | **敏感数据脱敏** | 列表展示时部分隐藏 | ✅ 已完成 |
| 3.5 | **二次验证** | 查看密码需二次确认 | ✅ 已完成 |
| 3.6 | **密钥轮转** | 支持 AES 密钥更换 | ✅ 已完成 |

### 阶段四：前端开发（优先级：高）

| 序号 | 功能 | 描述 | 工作量 |
|:----:|------|------|:------:|
| 4.1 | **Vue3 项目搭建** | Vite + Vue3 + TypeScript | ✅ 已完成 |
| 4.2 | **Element Plus 集成** | UI 组件库配置 | ✅ 已完成 |
| 4.3 | **登录页面** | 管理员登录界面 | ✅ 已完成 |
| 4.4 | **平台类型管理** | 类型列表、增删改 | ✅ 已完成 |
| 4.5 | **平台管理页面** | 平台列表、搜索、编辑 | ✅ 已完成 |
| 4.6 | **账号管理页面** | 账号表格、筛选、分页 | ✅ 已完成 |
| 4.7 | **账号详情弹窗** | 查看/编辑账号信息 | ✅ 已完成 |
| 4.8 | **密码复制功能** | 一键复制密码到剪贴板 | ✅ 已完成 |
| 4.9 | **响应式布局** | 适配移动端浏览 | ✅ 已完成 |
| 4.10 | **暗黑模式** | 支持深色主题 | ✅ 已完成 |

### 阶段五：用户体验优化（优先级：中）

| 序号 | 功能 | 描述 | 状态 |
|:----:|------|------|:------:|
| 5.1 | **快捷键支持** | Ctrl+C 复制密码等 | ✅ 已完成 |
| 5.2 | **收藏功能** | 常用账号收藏置顶 | ✅ 已完成 |
| 5.3 | **最近使用** | 显示最近访问的账号 | ✅ 已完成 |
| 5.4 | **统计仪表盘** | 账号数量、分布统计 | ✅ 已完成 |
| 5.5 | **数据可视化** | 图表展示账号分布 | ✅ 已完成 |
| 5.6 | **国际化** | 中英文切换 | ✅ 已完成 |

### 阶段六：高级功能（优先级：低）

| 序号 | 功能 | 描述 | 工作量 |
|:----:|------|------|:------:|
| 6.1 | **多用户支持** | 不同用户管理各自账号 | 3天 |
| 6.2 | **账号共享** | 用户间共享账号 | 2天 |
| 6.3 | **浏览器插件** | Chrome/Firefox 扩展 | 5天 |
| 6.4 | **移动端 APP** | Flutter/React Native | 10天 |
| 6.5 | **桌面客户端** | Electron 应用 | 5天 |
| 6.6 | **API 开放** | 提供第三方接入能力 | 2天 |
| 6.7 | **WebAuthn** | 生物识别认证 | 2天 |
| 6.8 | **密码同步** | 多设备数据同步 | 3天 |

---

## 🔧 技术改进建议

### 架构优化

| 建议 | 说明 | 状态 |
|------|------|:------:|
| **引入 Redis** | 缓存频繁访问数据、Session 管理 | 待开发 |
| **引入消息队列** | 异步处理日志、通知等 | 待开发 |
| **数据库读写分离** | 大量数据时性能优化 | 待开发 |
| **Docker 容器化** | 简化部署流程 | ✅ 已完成 |
| **CI/CD 流水线** | GitHub Actions 自动化 | ✅ 已完成 |

### 代码质量

| 建议 | 说明 | 状态 |
|------|------|:------:|
| **增加单元测试覆盖率** | 目标 80%+ | ✅ 已完成 |
| **集成测试** | 端到端测试 | ✅ 已完成 |
| **代码静态分析** | SonarQube 接入 | 待开发 |
| **API 版本控制** | 支持 v1、v2 等多版本 | 待开发 |
| **接口限流** | 防止恶意请求 | ✅ 已完成 |

### 安全加固

| 建议 | 说明 | 状态 |
|------|------|:------:|
| **密码加密算法升级** | 考虑 Argon2 替代 AES | 待开发 |
| **防 SQL 注入** | MyBatis Plus 已处理 | ✅ 已完成 |
| **防 XSS 攻击** | XssFilter 过滤器 | ✅ 已完成 |
| **CSRF 防护** | JWT 无状态认证 | ✅ 已完成 |
| **IP 黑名单** | 异常登录 IP 封禁 | 待开发 |

---

## 📅 推荐开发顺序

```
第1周：安全加固（阶段一）
  └── 用户认证 + JWT + 接口权限

第2周：前端基础（阶段四前半）
  └── Vue3 项目 + 登录页 + 平台管理

第3周：前端核心（阶段四后半）
  └── 账号管理页面 + 密码功能

第4周：功能增强（阶段二部分）
  └── 密码生成器 + 批量导入导出

第5周：数据安全 + 体验优化
  └── 审计日志 + 数据备份 + 收藏功能
```

---

## 📝 当前可运行

### 启动步骤

1. **初始化数据库**
   ```bash
   # 执行 SQL 脚本
   mysql -u root -p < sql/01_schema.sql
   mysql -u root -p account_manage < sql/02_init_data.sql
   mysql -u root -p account_manage < sql/03_security_tables.sql
   mysql -u root -p account_manage < sql/04_password_expiration.sql
   mysql -u root -p account_manage < sql/05_password_history_and_tags.sql
   mysql -u root -p account_manage < sql/06_favorites_and_recent.sql
   ```

2. **修改配置**
   - 编辑 `src/main/resources/application.yaml`
   - 修改数据库连接信息
   - 修改 JWT 密钥（生产环境必须修改）

3. **启动应用**
   ```bash
   ./mvnw spring-boot:run
   ```

4. **访问 API 文档**
   - Knife4j: http://localhost:8080/doc.html

### 默认管理员账号
- 用户名：`admin`
- 密码：`admin123`
- 说明：应用首次启动时自动创建

### 可用 API

| 方法 | 路径 | 说明 | 需认证 |
|------|------|------|:------:|
| POST | `/api/v1/auth/login` | 用户登录 | ❌ |
| POST | `/api/v1/auth/refresh` | 刷新令牌 | ❌ |
| POST | `/api/v1/auth/logout` | 用户登出 | ✅ |
| GET | `/api/v1/auth/me` | 获取当前用户信息 | ✅ |
| PUT | `/api/v1/auth/password` | 修改密码 | ✅ |
| GET | `/api/v1/platform-types` | 获取所有平台类型 | ✅ |
| GET | `/api/v1/platforms` | 分页查询平台 | ✅ |
| GET | `/api/v1/accounts` | 分页查询账号 | ✅ |
| GET | `/api/v1/accounts/{id}/password` | 获取解密密码 | ✅ |
| POST | `/api/v1/accounts` | 创建账号 | ✅ |
| PUT | `/api/v1/accounts/{id}` | 更新账号 | ✅ |
| DELETE | `/api/v1/accounts/{id}` | 删除账号 | ✅ |
| POST | `/api/v1/password/generate` | 生成密码 | ✅ |
| GET | `/api/v1/password/quick` | 快速生成密码 | ✅ |
| POST | `/api/v1/password/strength` | 检测密码强度 | ✅ |
| GET | `/api/v1/account/excel/export` | 导出所有账号 | ✅ |
| POST | `/api/v1/account/excel/import` | 批量导入账号 | ✅ |
| GET | `/api/v1/account/excel/template` | 下载导入模板 | ✅ |
| GET | `/api/v1/password/expiration` | 获取密码过期提醒 | ✅ |
| POST | `/api/v1/search/accounts` | 高级搜索账号 | ✅ |
| GET | `/api/v1/search/quick` | 快速关键词搜索 | ✅ |
| GET | `/api/v1/search/suggestions` | 搜索建议/自动补全 | ✅ |
| GET | `/api/v1/favorites` | 获取收藏列表 | ✅ |
| POST | `/api/v1/favorites/{id}` | 添加收藏 | ✅ |
| DELETE | `/api/v1/favorites/{id}` | 取消收藏 | ✅ |
| POST | `/api/v1/favorites/{id}/pin` | 置顶收藏 | ✅ |
| GET | `/api/v1/recent` | 最近访问账号 | ✅ |
| GET | `/api/v1/recent/frequent` | 最常访问账号 | ✅ |
| GET | `/api/v1/dashboard/stats` | 仪表盘统计 | ✅ |
| POST | `/api/v1/security/key/rotate` | 轮转AES密钥 | ✅ |
| GET | `/api/v1/security/key/generate` | 生成随机密钥 | ✅ |

---

## 📈 版本规划

| 版本 | 目标 | 预计时间 |
|------|------|----------|
| v1.0 | 后端基础功能完成 | ✅ 已完成 |
| v1.1 | 用户认证 + 基础安全 | ✅ 已完成 |
| v1.2 | 功能增强 + 数据安全 | ✅ 已完成 |
| v1.3 | 用户管理 + 日志查询 + 前端Token刷新 | ✅ 已完成 |
| v1.4 | 账号详情页 + 登录安全 + 单元测试 | ✅ 已完成 |
| v1.5 | 快捷操作 + 数据可视化 + 国际化 | ✅ 已完成 |
| v1.6 | Docker + CI/CD + XSS防护 | ✅ 已完成 |
| v1.7 | 响应式布局 + 移动端优化 | ✅ 已完成 |
| v1.8 | IP黑名单 + Redis缓存 + API版本控制 | ✅ 已完成 |
| v2.0 | 功能完善 + 体验优化 | 2周 |
| v3.0 | 多用户 + 移动端APP | 8周 |

---

*文档最后更新：2026-01-03*

---

## 🧪 单元测试覆盖

| 测试类 | 测试数 | 状态 |
|--------|:------:|:----:|
| `AuthServiceTest` | 14 | ✅ |
| `UserServiceTest` | 14 | ✅ |
| `UserControllerTest` | 13 | ✅ |
| `XssHttpServletRequestWrapperTest` | 9 | ✅ |
| `IpBlacklistServiceTest` | 19 | ✅ |
| **总计** | **69** | ✅ |
| `XssHttpServletRequestWrapperTest` | 9 | ✅ |
| **总计** | **50** | ✅ |

### 测试覆盖范围

- **AuthService**: 登录、登出、Token刷新、用户锁定/解锁、密码验证
- **UserService**: 用户CRUD、分页查询、状态管理、密码重置、唯一性校验
- **UserController**: REST API端点测试、认证验证、参数校验
- **XssFilter**: XSS攻击过滤、危险标签移除、HTML转义

运行测试：
```bash
./mvnw test -Dtest=AuthServiceTest,UserServiceTest,UserControllerTest,XssHttpServletRequestWrapperTest -DreuseForks=false
```
